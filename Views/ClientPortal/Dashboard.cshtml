@using JyotiIyerCPA.Models
@model ClientDashboardViewModel
@{
    ViewData["Title"] = "Client Dashboard";
    Layout = "~/Views/Shared/_ClientPortalLayout.cshtml";
}

<!-- Dashboard Header -->
<div class="dashboard-header mb-4">
    <div class="row align-items-center justify-content-center">
        <div class="col-md-8 text-center">
            <h1 class="dashboard-title">Welcome back, @Model.ClientName</h1>
            <p class="text-muted">Manage your tax documents and account settings</p>
        </div>
    </div>
</div>

<!-- Quick Stats Cards -->
<div class="row mb-4">
    <div class="col-md-6 mb-3">
        <div class="stat-card">
            <div class="stat-icon bg-primary">
                <i class="fas fa-calendar-alt"></i>
            </div>
            <div class="stat-content">
                <h3>@Model.UploadStats.CurrentTaxYear</h3>
                <p>Tax Year</p>
            </div>
        </div>
    </div>
    <div class="col-md-6 mb-3">
        <div class="stat-card">
            <div class="stat-icon bg-info">
                <i class="fas fa-upload"></i>
            </div>
            <div class="stat-content">
                <h3>@Model.UploadStats.TotalUploads</h3>
                <p>Total Uploads This Tax Year</p>
            </div>
        </div>
    </div>
</div>

<!-- Main Content Area -->
<div class="row">
    <!-- File Upload Section -->
    <div class="col-lg-8 mb-4">
        <!-- Document Upload Section -->
        <div class="upload-section">
            <div class="section-header">
                <h3><i class="fas fa-file-alt me-2"></i>Upload Documents</h3>
                <p class="text-muted">Click on any document type to upload files</p>
            </div>
            <div class="document-grid">
                <!-- Miscellaneous Document - First -->
                <div class="document-type-card" data-type="Miscellaneous" role="button" tabindex="0" aria-label="Upload Miscellaneous documents">
                    <div class="document-icon">
                        <i class="fas fa-file-upload"></i>
                    </div>
                    <h5>Miscellaneous</h5>
                    <p>Other Documents</p>
                    <div class="upload-count">0 files</div>
                </div>

                <!-- Standard Tax Documents -->
                <div class="document-type-card" data-type="W2" role="button" tabindex="0" aria-label="Upload W2 documents">
                    <div class="document-icon">
                        <i class="fas fa-file-invoice"></i>
                    </div>
                    <h5>W2</h5>
                    <p>Wage and Tax Statement</p>
                    <div class="upload-count">0 files</div>
                </div>
                <div class="document-type-card" data-type="1099 Int" role="button" tabindex="0" aria-label="Upload 1099 Interest documents">
                    <div class="document-icon">
                        <i class="fas fa-percentage"></i>
                    </div>
                    <h5>1099 Int</h5>
                    <p>Interest Income</p>
                    <div class="upload-count">0 files</div>
                </div>
                <div class="document-type-card" data-type="1099 Div" role="button" tabindex="0" aria-label="Upload 1099 Dividend documents">
                    <div class="document-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <h5>1099 Div</h5>
                    <p>Dividend Income</p>
                    <div class="upload-count">0 files</div>
                </div>
                <div class="document-type-card" data-type="1099-B" role="button" tabindex="0" aria-label="Upload 1099-B documents">
                    <div class="document-icon">
                        <i class="fas fa-exchange-alt"></i>
                    </div>
                    <h5>1099-B</h5>
                    <p>Broker Transactions</p>
                    <div class="upload-count">0 files</div>
                </div>
                <div class="document-type-card" data-type="1099 Consolidated" role="button" tabindex="0" aria-label="Upload 1099 Consolidated documents">
                    <div class="document-icon">
                        <i class="fas fa-layer-group"></i>
                    </div>
                    <h5>1099 Consolidated</h5>
                    <p>Combined 1099 Forms</p>
                    <div class="upload-count">0 files</div>
                </div>
                <div class="document-type-card" data-type="1098" role="button" tabindex="0" aria-label="Upload 1098 documents">
                    <div class="document-icon">
                        <i class="fas fa-home"></i>
                    </div>
                    <h5>1098</h5>
                    <p>Mortgage Interest</p>
                    <div class="upload-count">0 files</div>
                </div>
                <div class="document-type-card" data-type="1099 SA" role="button" tabindex="0" aria-label="Upload 1099 SA documents">
                    <div class="document-icon">
                        <i class="fas fa-piggy-bank"></i>
                    </div>
                    <h5>1099 SA</h5>
                    <p>HSA Distributions</p>
                    <div class="upload-count">0 files</div>
                </div>
                <div class="document-type-card" data-type="Schedule K-1" role="button" tabindex="0" aria-label="Upload Schedule K-1 documents">
                    <div class="document-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <h5>Schedule K-1</h5>
                    <p>Partnership Income</p>
                    <div class="upload-count">0 files</div>
                </div>
                <div class="document-type-card" data-type="1099-T" role="button" tabindex="0" aria-label="Upload 1099-T documents">
                    <div class="document-icon">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <h5>1099-T</h5>
                    <p>Tuition Statement</p>
                    <div class="upload-count">0 files</div>
                </div>
                <div class="document-type-card" data-type="1098-E" role="button" tabindex="0" aria-label="Upload 1098-E documents">
                    <div class="document-icon">
                        <i class="fas fa-book"></i>
                    </div>
                    <h5>1098-E</h5>
                    <p>Student Loan Interest</p>
                    <div class="upload-count">0 files</div>
                </div>
                <div class="document-type-card" data-type="5478" role="button" tabindex="0" aria-label="Upload 5478 documents">
                    <div class="document-icon">
                        <i class="fas fa-file-medical"></i>
                    </div>
                    <h5>5478</h5>
                    <p>Health Coverage Credit</p>
                    <div class="upload-count">0 files</div>
                </div>
                <div class="document-type-card" data-type="1099-R" role="button" tabindex="0" aria-label="Upload 1099-R documents">
                    <div class="document-icon">
                        <i class="fas fa-university"></i>
                    </div>
                    <h5>1099-R</h5>
                    <p>Retirement Distributions</p>
                    <div class="upload-count">0 files</div>
                </div>
                <div class="document-type-card" data-type="SSA-1099" role="button" tabindex="0" aria-label="Upload SSA-1099 documents">
                    <div class="document-icon">
                        <i class="fas fa-id-card"></i>
                    </div>
                    <h5>SSA-1099</h5>
                    <p>Social Security Benefits</p>
                    <div class="upload-count">0 files</div>
                </div>
                <div class="document-type-card" data-type="529 Contributions" role="button" tabindex="0" aria-label="Upload 529 Contributions documents">
                    <div class="document-icon">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <h5>529 Contributions</h5>
                    <p>Education Savings Plan</p>
                    <div class="upload-count">0 files</div>
                </div>
                <div class="document-type-card" data-type="IRA Contributions" role="button" tabindex="0" aria-label="Upload IRA Contributions documents">
                    <div class="document-icon">
                        <i class="fas fa-coins"></i>
                    </div>
                    <h5>IRA Contributions</h5>
                    <p>Retirement Account Contributions</p>
                    <div class="upload-count">0 files</div>
                </div>
                <div class="document-type-card" data-type="Estimated Taxes Paid" role="button" tabindex="0" aria-label="Upload Estimated Taxes documents">
                    <div class="document-icon">
                        <i class="fas fa-calculator"></i>
                    </div>
                    <h5>Estimated Taxes</h5>
                    <p>Quarterly Tax Payments</p>
                    <div class="upload-count">0 files</div>
                </div>
                <div class="document-type-card" data-type="Foreign Income" role="button" tabindex="0" aria-label="Upload Foreign Income documents">
                    <div class="document-icon">
                        <i class="fas fa-globe-americas"></i>
                    </div>
                    <h5>Foreign Income</h5>
                    <p>International Income & Assets</p>
                    <div class="upload-count">0 files</div>
                </div>
                <div class="document-type-card" data-type="Rental Property" role="button" tabindex="0" aria-label="Upload Rental Property documents">
                    <div class="document-icon">
                        <i class="fas fa-building"></i>
                    </div>
                    <h5>Rental Property</h5>
                    <p>Income & Expenses</p>
                    <div class="upload-count">0 files</div>
                </div>
                <div class="document-type-card" data-type="Business Income/Expenses" role="button" tabindex="0" aria-label="Upload Business documents">
                    <div class="document-icon">
                        <i class="fas fa-briefcase"></i>
                    </div>
                    <h5>Business Docs</h5>
                    <p>Income & Expenses</p>
                    <div class="upload-count">0 files</div>
                </div>
                <div class="document-type-card" data-type="Prior Year Tax Returns" role="button" tabindex="0" aria-label="Upload Prior Year Tax Returns">
                    <div class="document-icon">
                        <i class="fas fa-file-archive"></i>
                    </div>
                    <h5>Prior Year Returns</h5>
                    <p>For New Clients</p>
                    <div class="upload-count">0 files</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sidebar -->
    <div class="col-lg-4">
        <!-- All Uploads -->
        <div class="sidebar-section mb-4">
            <h4><i class="fas fa-file-alt me-2"></i>All Uploads</h4>

            <!-- Mini Search and Filter -->
            <div class="uploads-search-container mb-3">
                <div class="search-filter-wrapper">
                    <div class="search-input-wrapper">
                        <div class="input-group">
                            <span class="input-group-text">
                                <i class="fas fa-search"></i>
                            </span>
                            <input type="text" class="form-control" id="uploadsSearch" placeholder="Search uploads...">
                        </div>
                    </div>
                    <div class="filter-wrapper">
                        <select class="form-select" id="uploadsFilter">
                            <option value="">All Types</option>
                            <option value="Miscellaneous">Miscellaneous</option>
                            <option value="W2">W2</option>
                            <option value="1099 Int">1099 Int</option>
                            <option value="1099 Div">1099 Div</option>
                            <option value="1099-B">1099-B</option>
                            <option value="1099 Consolidated">1099 Consolidated</option>
                            <option value="1098">1098</option>
                            <option value="1099 SA">1099 SA</option>
                            <option value="Schedule K-1">Schedule K-1</option>
                            <option value="1099-T">1099-T</option>
                            <option value="1098-E">1098-E</option>
                            <option value="5478">5478</option>
                            <option value="1099-R">1099-R</option>
                            <option value="SSA-1099">SSA-1099</option>
                            <option value="529 Contributions">529 Contributions</option>
                            <option value="IRA Contributions">IRA Contributions</option>
                            <option value="Estimated Taxes Paid">Estimated Taxes Paid</option>
                            <option value="Foreign Income">Foreign Income</option>
                            <option value="Rental Property">Rental Property</option>
                            <option value="Business Income/Expenses">Business Income/Expenses</option>
                            <option value="Prior Year Tax Returns">Prior Year Tax Returns</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="all-uploads">
                @foreach (var upload in Model.RecentUploads)
                {
                    <div class="upload-item" data-filename="@upload.FileName.ToLower()" data-type="@upload.FileType.ToLower()">
                        <div class="upload-info">
                            <h6>@upload.FileName</h6>
                            <p class="text-muted">@upload.FileType • @upload.UploadDate.ToString("MMM dd, yyyy")</p>
                        </div>
                        <div class="upload-status">
                            <span class="badge @(upload.Status == "Processed" ? "bg-success" : "bg-warning")">
                                @upload.Status
                            </span>
                        </div>
                    </div>
                }
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="sidebar-section mb-2">
            <h4><i class="fas fa-bolt me-2"></i>Quick Actions</h4>
            <div class="quick-actions">
                <button class="btn btn-outline-success quick-action-btn w-100 mb-3" onclick="scheduleAppointment()">
                    <div class="quick-action-content">
                        <i class="fas fa-calendar-plus quick-action-icon-simple"></i>
                        <div class="quick-action-text">
                            <span class="quick-action-title">Schedule Appointment</span>
                            <small class="quick-action-subtitle">Book a consultation</small>
                        </div>
                    </div>
                </button>
                <button class="btn btn-outline-info quick-action-btn w-100" onclick="contactCPA()">
                    <div class="quick-action-content">
                        <i class="fas fa-envelope quick-action-icon-simple"></i>
                        <div class="quick-action-text">
                            <span class="quick-action-title">Contact CPA</span>
                            <small class="quick-action-subtitle">Send a message</small>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Upload Modal -->
<div class="modal fade" id="uploadModal" tabindex="-1" aria-labelledby="uploadModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="uploadModalLabel">
                    <i class="fas fa-upload me-2"></i>Upload Document
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="documentUploadForm">
                    <input type="hidden" id="selectedDocumentType">
                    <div class="mb-3">
                        <label class="form-label fw-semibold">Document Type</label>
                        <input type="text" class="form-control" id="documentTypeDisplay" readonly>
                    </div>
                    <div class="mb-3" id="customDocumentTypeContainer" style="display: none;">
                        <label class="form-label fw-semibold">Custom Document Type *</label>
                        <input type="text" class="form-control" id="customDocumentType" placeholder="Enter document type">
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-semibold">Document Name (Optional)</label>
                        <input type="text" class="form-control" id="documentFileName" placeholder="Enter custom document name">
                    </div>
                    <div class="upload-area" id="modalUploadArea">
                        <div class="upload-content">
                            <i class="fas fa-cloud-upload-alt upload-icon"></i>
                            <p class="upload-text">Drag & drop your files here or <span class="upload-link">browse</span></p>
                            <input type="file" id="documentFileInput" accept=".pdf,.jpg,.jpeg,.png,.doc,.docx" multiple hidden>
                            <p class="upload-note">Supports: PDF, JPG, PNG, DOC, DOCX (Max 10MB per file)</p>
                        </div>
                    </div>
                    <div id="fileList" class="file-list mt-3"></div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="fas fa-times me-2"></i>Cancel
                </button>
                <button type="button" class="btn btn-primary" id="uploadDocumentBtn">
                    <i class="fas fa-upload me-2"></i>Upload Documents
                </button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/js/client-portal.js"></script>
}
